<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggOceanMaps">
<title>ggOceanMaps User Manual • ggOceanMaps</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ggOceanMaps User Manual">
<meta property="og:description" content="ggOceanMaps">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggOceanMaps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/ggOceanMaps.html">User manual</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Customising shapefiles</h6>
    <a class="dropdown-item" href="../articles/premade-shapefiles.html">Premade shapefiles</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Presentations</h6>
    <a class="dropdown-item" href="../articles/poster.html">SI2022 poster</a>
    <a class="external-link dropdown-item" href="https://aen-r-workshop.github.io/4-ggOceanMaps/ggOceanMaps_workshop.html">AeN workshop slides</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MikkoVihtakari/ggOceanMaps/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>ggOceanMaps User Manual</h1>
                        <h4 data-toc-skip class="author">Mikko Vihtakari
(Institute of Marine Research)</h4>
            
            <h4 data-toc-skip class="date">16 September, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MikkoVihtakari/ggOceanMaps/blob/HEAD/vignettes/ggOceanMaps.Rmd" class="external-link"><code>vignettes/ggOceanMaps.Rmd</code></a></small>
      <div class="d-none name"><code>ggOceanMaps.Rmd</code></div>
    </div>

    
    
<p>The ggOceanMaps package for <a href="https://www.r-project.org/" class="external-link">R</a> allows plotting data on
bathymetric maps using <a href="https://ggplot2.tidyverse.org/reference/" class="external-link">ggplot2</a>. The package
is designed for ocean sciences and greatly simplifies bathymetric map
plotting anywhere around the globe. ggOceanMaps uses openly available
geographic data. Citing the particular data sources is advised by the
CC-BY licenses whenever maps from the package are published (see the <a href="#citations-and-data-sources"><em>Citations and data
sources</em></a> section). Note that the package comes with absolutely
no warranty and that maps generated by the package are meant for
plotting scientific data only. The maps are coarse generalizations of
third party data and therefore inaccurate.</p>
<div class="section level2">
<h2 id="basic-use">Basic use<a class="anchor" aria-label="anchor" href="#basic-use"></a>
</h2>
<p><strong>ggOceanMaps</strong> extends on <a href="https://ggplot2.tidyverse.org/reference/" class="external-link"><strong>ggplot2</strong></a>.
Data that contain geographic information can be plotted on the maps
generated by ggOceanMaps using the ggplot2 layers separated by the
<code>+</code> operator. The package uses spatial shapefiles, <a href="https://CRAN.R-project.org/view=Spatial" class="external-link">GIS packages for R</a> to
manipulate, and the <a href="https://CRAN.R-project.org/package=ggspatial" class="external-link"><strong>ggspatial</strong></a>
package to help to plot these shapefiles. The shapefile plotting is
conducted internally in the <code>basemap</code> function and uses <a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot’s sf
object plotting capabilities</a>.</p>
<p>The primary aim of ggOceanMaps is to make plotting oceanographic
spatial data as simple as feasible, but also flexible for custom
modifications. The “as simple as feasible” part will be covered in this
section, while the “flexible for custom modifications” part is covered
in the <a href="#advanced-use">Advanced use</a> section. The basic use
section of this tutorial assumes that the user knows how to use ggplot.
If you are not familiar with this package, you may read the <a href="https://r4ds.had.co.nz/data-visualisation.html" class="external-link">Data
visualization</a> section in <a href="https://r4ds.had.co.nz/" class="external-link">Hadley
Wickham &amp; Garrett Grolemund</a>. This tutorial does not describe
functions in ggOceanMaps but rather focusses on how to use them. Make
sure to refer to the function documentation while reading the
tutorial.</p>
<p>The package requires the <code>ggOceanMapsData</code> package which
is not available on CRAN but should be installed automatically when you
load <code>ggOceanMaps</code> for the first time. If the automatic
installation does not work, please use:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggOceanMapsData"</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://mikkovihtakari.github.io/drat"</span>, <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Once the packages have been installed, you can load them
normally:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mikkovihtakari.github.io/ggOceanMaps/" class="external-link">ggOceanMapsData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mikkovihtakari.github.io/ggOceanMaps/" class="external-link">ggOceanMaps</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="limits">Limits<a class="anchor" aria-label="anchor" href="#limits"></a>
</h3>
<p>To ensure simplicity, ggOceanMaps package attempts to use <a href="https://en.wikipedia.org/wiki/Decimal_degrees" class="external-link">decimal degree</a>
<a href="https://en.wikipedia.org/wiki/Coordinate_system" class="external-link">coordinate
system</a> as much as possible. This system represents coordinates on a
sphere, while maps are plotted in two dimensions. Therefore, the
underlying map data have to be projected using <a href="#projections">different mathematical algorithms depending on the
geographic location</a>. The simplest way of defining the geographic
location is to use the <code>limits</code> argument with decimal
degrees. The limits argument can be defined either as a numeric vector
of length 1 or 4. Specifying the argument as a single integer between 30
and 88 or -88 and -30 plots a polar stereographic map for the Arctic or
Antarctic, respectively.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mikkovihtakari.github.io/ggOceanMaps/" class="external-link">ggOceanMaps</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fl">60</span><span class="op">)</span> <span class="co"># A synonym: basemap(60) </span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Rectangular maps are plotted by specifying the <code>limits</code>
argument as a numeric vector of length 4 where the first element defines
the start longitude, the second element the end longitude, the third
element the minimum latitude and the fourth element the maximum latitude
of the bounding box:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">59</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Limiting maps using decimal degrees is somewhat counter-intuitive
because maps plotted for polar regions (&gt;= 60 or &lt;= -60 latitude)
are actually projected to Arctic and Antarctic polar stereographic
systems. Because decimal degrees are angular units running
counter-clockwise, also the longitude limits have to be defined
<strong>counter-clockwise</strong>. Projected maps with decimal degree
<code>limits</code> will lead to expanded limits towards the poles when
using Arctic and Atlantic Polar Stereographic projections because
decimal degrees represent a sphere:</p>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
<p>The figure above: Limiting rectangular basemaps is done by placing
four coordinates to the limit argument. A) If the limits are in decimal
degrees, the longitude limits (<code>[1:2]</code>) specify the start and
end segments of corresponding angular lines that should reside inside
the map area. The longitude limits are defined
<strong>counter-clockwise</strong>. The latitude limits
<code>[3:4]</code> define the parallels that should reside inside the
limited region given the longitude segments. Note that the resulting
limited region (polygon with thick red borders) becomes wider than the
polygon defined by the coordinates (thin red borders). The example
limits are <code>c(120, -120, 60, 80)</code>. B) If the limits are given
as projected coordinates or as decimal degrees for maps with |latitude|
&lt; 60, limits elements represent lines encompassing the map area in
cartesian space. The example limits are the limits from A) projected to
the Arctic stereographic (crs = 3995). When limiting basemaps using
data, the limits are calculated for the maximum reach of projected
coordinates as in B but with an added buffer to place all points inside
the map area.</p>
<p>As an example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">160</span>, <span class="fl">160</span>, <span class="op">-</span><span class="fl">160</span>, <span class="op">-</span><span class="fl">160</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">80</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">160</span>, <span class="op">-</span><span class="fl">160</span>, <span class="fl">60</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/stat_spatial_identity.html" class="external-link">geom_spatial_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Exact control of map limits can be difficult using decimal degree
limits in polar regions. The <code>limits</code> argument also allows
specifying the limits in the underlying projected coordinate units.
First, we will need to find out how these units look like:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fl">60</span>, projection.grid <span class="op">=</span> <span class="cn">TRUE</span>, grid.col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>The <code>projection.grid</code> argument plots a grid using the
projected actual map coordinates instead of decimal degrees. The grid
helps in defining the <code>limits</code> using projected coordinates
giving better control over the map limits than decimal degree
coordinates. The automatic shapefile definition algorithm does not work
for projected coordinates. Therefore, if the limits are not given as
decimal degrees (any longitude outside the range [-180, 180] or latitude
[-90, 90]), the function asks to specify <code>shapefiles</code>. The
<code>shapefiles</code> can be defined by partially matching the names
of the pre-made shapefiles in <code>shapefile_list</code> (e.g. “Ar”
would be enough for “ArcticStereographic”):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2e6</span>, <span class="fl">1e6</span>, <span class="fl">0</span>, <span class="fl">3e6</span><span class="op">)</span>, shapefiles <span class="op">=</span> <span class="st">"Arctic"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="data-limits">Data limits<a class="anchor" aria-label="anchor" href="#data-limits"></a>
</h3>
<p>The limits of a map can also be defined by inputting a data frame to
the <code>data</code> argument. The limits are automatically defined
allowing the user to quickly find limits for a desired spatial
dataset:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">160</span>, <span class="op">-</span><span class="fl">160</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span> <span class="op">+</span> <span class="co"># a synonym: basemap(dt)</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/stat_spatial_identity.html" class="external-link">geom_spatial_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Note how the function expands the map to make all data fit inside the
map area compared to a similar plot using the <code>limits</code>
argument above. The function automatically detects columns containing
longitude and latitude information. The automatic detection algorithm is
not very advanced and it is recommended to use intuitive column names
for longitude (such as “lon”, “long”, or “longitude”) and latitude
(“lat”, “latitude”) columns. The coordinate data have to be given as
decimal degrees for the <code>data</code> argument to function.</p>
</div>
<div class="section level3">
<h3 id="bathymetry-and-glaciers">Bathymetry and glaciers<a class="anchor" aria-label="anchor" href="#bathymetry-and-glaciers"></a>
</h3>
<p>It is advised to limit your map first and only then plot bathymetry
and glaciers to save the processing time of your computer (the
bathymetry shapes can be large). Bathymetry is plotted simply by
specifying <code>bathymetry = TRUE</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">160</span>, <span class="op">-</span><span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Glaciers can be plotted using the <code>glaciers</code> argument:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fl">60</span>, glaciers <span class="op">=</span> <span class="cn">TRUE</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="adding-data-to-maps">Adding data to maps<a class="anchor" aria-label="anchor" href="#adding-data-to-maps"></a>
</h3>
<p>The <code>basemap(...)</code> function works almost similarly to the
<code>ggplot(...)</code> function as a base for adding further layers to
the plot. The difference between the <code><a href="../reference/basemap.html">basemap()</a></code> and the
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> is that the <code><a href="../reference/basemap.html">basemap()</a></code> plot already
contains multiple ggplot layers. All layers except bathymetry have no
other <code>aes</code> mapping than <code>x</code>, <code>y</code> and
<code>group</code>. Bathymetry is mapped to <code>fill</code> or
<code>color</code> color in addition. This means that when you add
ggplot layers, you need to specify the <code>data</code> argument
explicitly as shown below. Another difference is that basemaps are
plotted using projected coordinates. The <a href="https://CRAN.R-project.org/package=ggspatial" class="external-link">ggspatial</a> and
ggplot’s <a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link"><code>geom_sf</code></a>
functions convert the coordinates automatically to the projected
coordinates:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">180</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span>, lat <span class="op">=</span> <span class="op">-</span><span class="fl">70</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="op">-</span><span class="fl">60</span>, glaciers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/stat_spatial_identity.html" class="external-link">geom_spatial_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>The ggplot functions can also be used, but the coordinates need to be
transformed to the basemap projection first using the
<code>transform_coord</code> function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="op">-</span><span class="fl">60</span>, glaciers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/transform_coord.html">transform_coord</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Note that the maps plotted in temperate and tropical regions are not
projected. Consequently, decimal degrees work for such maps
directly:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">80</span>, <span class="op">-</span><span class="fl">60</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">40</span><span class="op">)</span>, var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>The <code>transform_coord</code> function detects the projection
automatically, given that the map is limited using a similar range of
coordinates. Therefore you can use the <code>transform_coord</code> as
demonstrated above whenever using standard ggplot layers.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/transform_coord.html">transform_coord</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="op">-</span><span class="fl">80</span>, lat <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, bind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lon lat lon.proj lat.proj</span></span>
<span><span class="co">#&gt; 1 -80  25      -80       25</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rotating-maps">Rotating maps<a class="anchor" aria-label="anchor" href="#rotating-maps"></a>
</h3>
<p>The stereographic maps can be rotated to point towards north using
the <code>rotate</code> argument:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">160</span>, <span class="op">-</span><span class="fl">80</span>, <span class="fl">60</span>, <span class="fl">85</span><span class="op">)</span>, rotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>A word of warning, however: the rotation involves reprojecting all
shapefiles in their entirety and is memory consuming especially for
large bathymetry shapes. Make sure to limit your map correctly before
you add bathymetry. The rotation is still experimental and does not work
for <code>limit</code>s defined using projected coordinates or
<code>data</code>. This functionality is likely to contain a whole lot
of bugs. Rotation does not currently work within the
<code><a href="../reference/transform_coord.html">transform_coord()</a></code> function. Use the
<code>ggspatial::geom_spatial_*</code> functions when adding data to
rotated maps.</p>
</div>
<div class="section level3">
<h3 id="quick-map">Quick map<a class="anchor" aria-label="anchor" href="#quick-map"></a>
</h3>
<p>The <code>qmap</code> function is designed as a shortcut to quickly
take a look at a spatial dataset similar to the ggplot’s <a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link"><code>qplot</code></a>
function. This function is supposed to automatically detect the type of
data fed into the function and plot a map using appropriate geometries,
limits, and projection. You can use the <code>expand.factor</code>
argument to adjust the automatic zoom into <code>data</code>. Note that
too large <code>expand.factor</code> values will lead to errors.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">80</span>, <span class="op">-</span><span class="fl">60</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">40</span><span class="op">)</span>, var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/qmap.html">qmap</a></span><span class="op">(</span><span class="va">dt</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="co"># set color</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qmap.html">qmap</a></span><span class="op">(</span><span class="va">dt</span>, color <span class="op">=</span> <span class="va">var</span>, expand.factor <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span> <span class="co"># map color, zoom out</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="detailed-maps">Detailed maps<a class="anchor" aria-label="anchor" href="#detailed-maps"></a>
</h3>
<p>Detailed shapefiles are stored in the <a href="https://github.com/MikkoVihtakari/ggOceanMapsLargeData" class="external-link">ggOceanMapsLargeData</a>
repository and downloaded as needed. Available shapefiles can be viewed
using the <code><a href="../reference/shapefile_list.html">shapefile_list()</a></code> function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/shapefile_list.html">shapefile_list</a></span><span class="op">(</span><span class="st">"all"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     name                            land</span></span>
<span><span class="co">#&gt; 1    ArcticStereographic    ggOceanMapsData::arctic_land</span></span>
<span><span class="co">#&gt; 2 AntarcticStereographic ggOceanMapsData::antarctic_land</span></span>
<span><span class="co">#&gt; 3          DecimalDegree        ggOceanMapsData::dd_land</span></span>
<span><span class="co">#&gt; 4               Svalbard                   svalbard_land</span></span>
<span><span class="co">#&gt; 5             BarentsSea                 barentssea_land</span></span>
<span><span class="co">#&gt; 6                  IBCAO    ggOceanMapsData::arctic_land</span></span>
<span><span class="co">#&gt;                              glacier                            bathy   crs</span></span>
<span><span class="co">#&gt; 1    ggOceanMapsData::arctic_glacier    ggOceanMapsData::arctic_bathy  3995</span></span>
<span><span class="co">#&gt; 2 ggOceanMapsData::antarctic_glacier ggOceanMapsData::antarctic_bathy  3031</span></span>
<span><span class="co">#&gt; 3        ggOceanMapsData::dd_glacier        ggOceanMapsData::dd_bathy  4326</span></span>
<span><span class="co">#&gt; 4                   svalbard_glacier                   svalbard_bathy 32633</span></span>
<span><span class="co">#&gt; 5                 barentssea_glacier                 barentssea_bathy 32636</span></span>
<span><span class="co">#&gt; 6    ggOceanMapsData::arctic_glacier                      ibcao_bathy  3995</span></span>
<span><span class="co">#&gt;                                                                                     path</span></span>
<span><span class="co">#&gt; 1                                                                                   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2                                                                                   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3                                                                                   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4    https://github.com/MikkoVihtakari/ggOceanMapsLargeData/raw/master/data/svalbard.rda</span></span>
<span><span class="co">#&gt; 5  https://github.com/MikkoVihtakari/ggOceanMapsLargeData/raw/master/data/barentssea.rda</span></span>
<span><span class="co">#&gt; 6 https://github.com/MikkoVihtakari/ggOceanMapsLargeData/raw/master/data/ibcao_bathy.rda</span></span></code></pre></div>
<p>Plotting shapefiles from the list is done as for any other shapes.
Note that the projection of the shapefiles varies.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>shapefiles <span class="op">=</span> <span class="st">"BarentsSea"</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://mikkovihtakari.github.io/PlotSvalbard/articles/PlotSvalbard_files/figure-html/bathystyle-1.png"></p>
<p>The Svalbard map from the <a href="https://github.com/MikkoVihtakari/PlotSvalbard" class="external-link">PlotSvalbard</a>
package:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>shapefiles <span class="op">=</span> <span class="st">"Svalbard"</span>, glaciers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="https://mikkovihtakari.github.io/PlotSvalbard/articles/PlotSvalbard_files/figure-html/unnamed-chunk-2-1.png" alt=""><p class="caption">The PlotSvalbard maps can also be generated using
ggOceanMaps with the ggOceanMapsLargeData extension. The function asks
to download the data when you use it for the first time.</p>
</div>
<p>Kongsfjorden from the <a href="https://github.com/MikkoVihtakari/PlotSvalbard" class="external-link">PlotSvalbard</a>
package:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10.9</span>, <span class="fl">12.65</span>, <span class="fl">78.83</span>, <span class="fl">79.12</span><span class="op">)</span>, </span>
<span>        bathymetry <span class="op">=</span> <span class="cn">TRUE</span>, shapefiles <span class="op">=</span> <span class="st">"Svalbard"</span>,</span>
<span>        legends <span class="op">=</span> <span class="cn">FALSE</span>, glaciers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://mikkovihtakari.github.io/PlotSvalbard/articles/PlotSvalbard_files/figure-html/unnamed-chunk-17-1.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="advanced-use">Advanced use<a class="anchor" aria-label="anchor" href="#advanced-use"></a>
</h2>
<p>This section focuses on flexibility and user modifications. It is
assumed that advanced users understand the basics of geographic
information systems (GIS) and how to use these systems in R (e.g. see
the <a href="https://geocompr.robinlovelace.net/adv-map.html" class="external-link">Making
Maps with R</a> chapter in <a href="https://geocompr.robinlovelace.net/index.html" class="external-link">Lovelace et
al. 2020</a>).</p>
<div class="section level3">
<h3 id="projections">Projections<a class="anchor" aria-label="anchor" href="#projections"></a>
</h3>
<p>The <code>basemap</code> function uses the <code>limits</code>
argument to automatically detect the required projection for a map (or
the <code>data</code> argument to calculate <code>limits</code>). The
algorithms deciding which projection to use are defined in
<code>define_shapefiles</code> and <code>shapefile_list</code>
functions. These conditions are expected to change during the
development of the package and documented information here or in the
<code>basemap</code> function might be outdated. Make sure to check the
projection definition functions for up-to-date information. At the time
of writing, the function uses three different projections (given as <a href="https://epsg.io/" class="external-link">EPSG codes</a>):</p>
<ul>
<li>
<strong>3995</strong> WGS 84 / Arctic Polar Stereographic. Called
“ArcticStereographic”. For max latitude (<code>limits[4]</code>) &gt;=
60 (if min latitude (<code>limits[3]</code>) &gt;= 30), and single
integer latitudes &gt;= 30 and &lt;= 89.</li>
<li>
<strong>3031</strong> WGS 84 / Antarctic Polar Stereographic. Called
“AntarcticStereographic”. For max latitude (<code>limits[4]</code>)
&lt;= -60 (if min latitude (<code>limits[3]</code>) &lt;= -30), and
single integer latitudes &lt;= -30 and &gt;= -89.</li>
<li>
<strong>4326</strong> WGS 84 / World Geodetic System 1984, used in
GPS. Called “DecimalDegree”. For min latitude (<code>limits[3]</code>)
&lt; 30 or &gt; -30, max latitude (<code>limits[4]</code>) &lt; 60 or
&gt; -60, and single integer latitudes &lt; 30 and &gt; -30.</li>
</ul>
<p>The <code>basemap</code> function uses pre-transformed shapefiles for
each of the projections above (defined in <code>shapefile_list</code>).
This is to make the plotting quicker and more memory efficient but leads
to larger data size required by the package.</p>
</div>
<div class="section level3">
<h3 id="appearance">Appearance<a class="anchor" aria-label="anchor" href="#appearance"></a>
</h3>
<div class="section level4">
<h4 id="bathymetry-styles">Bathymetry styles<a class="anchor" aria-label="anchor" href="#bathymetry-styles"></a>
</h4>
<p>The <code>basemap</code> function contains four pre-made bathymetry
styles defined using the <code>bathy.style</code> argument. Two of these
alternatives (<code>"poly_*"</code>) have been mapped to
<code>fill</code> using the <code>geom_polygon</code> function, while
the two others (<code>contour_*</code>) have been mapped to
<code>color</code>. The default style (<code>"poly_blues"</code>) has
been displayed throughout this user manual. The other styles are:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">46</span>, <span class="fl">70</span>, <span class="fl">81</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span>, bathy.style <span class="op">=</span> <span class="st">"poly_greys"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">46</span>, <span class="fl">70</span>, <span class="fl">81</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span>, bathy.style <span class="op">=</span> <span class="st">"contour_blues"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-22-2.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">46</span>, <span class="fl">70</span>, <span class="fl">81</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span>, bathy.style <span class="op">=</span> <span class="st">"contour_grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-22-3.png" width="700"></p>
<div class="section level5">
<h5 id="customizing-bathymetry-styles">Customizing bathymetry styles<a class="anchor" aria-label="anchor" href="#customizing-bathymetry-styles"></a>
</h5>
<p>The <code>bathy.style = "poly_*"</code> bathymetry polygons are
mapped to <code>geom_fill_discrete</code> and can be modifying using
standard ggplot syntax:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">140</span>, <span class="op">-</span><span class="fl">105</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="st">"Water depth (m)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>The <code>bathy.style = "contour_*"</code> bathymetry lines are
mapped to <code>geom_color_discrete</code> and can be modifying using
standard ggplot syntax:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span>, <span class="fl">68</span>, <span class="fl">80</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span>, bathy.style <span class="op">=</span> <span class="st">"contour_blues"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_hue.html" class="external-link">scale_color_hue</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
</div>
<div class="section level4">
<h4 id="graphical-parameters">Graphical parameters<a class="anchor" aria-label="anchor" href="#graphical-parameters"></a>
</h4>
<p>The <code>basemap</code> function uses graphical parameters that
(very objectively) happen to please the eye of the author and have
worked in the applications needed by the author. The default parameters
may suddenly change without warning. You may want to modify the
appearances of a <code>basemap</code> to your own liking. This can be
done using the <code>*.col</code> (fill), <code>*.border.col</code>
(line color) and <code>*.size</code> (line width) arguments:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">55</span>, <span class="fl">70</span><span class="op">)</span>, glaciers <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        bathymetry <span class="op">=</span> <span class="cn">TRUE</span>, bathy.style <span class="op">=</span> <span class="st">"poly_greys"</span>,</span>
<span>        land.col <span class="op">=</span> <span class="st">"#eeeac4"</span>, gla.col <span class="op">=</span> <span class="st">"cadetblue"</span>, </span>
<span>        land.border.col <span class="op">=</span> <span class="cn">NA</span>, gla.border.col <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>        grid.size <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>Graticules (the grid lines) can be removed by setting the
<code>grid.col</code> to <code>NA</code>. Axis labels can be manipulated
using standard ggplot code:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">124</span>, <span class="fl">148</span>, <span class="fl">31</span>, <span class="fl">50</span><span class="op">)</span>, grid.col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Only latitude for you, ..."</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="add-scale-bar-and-north-arrow">Add scale bar and north arrow<a class="anchor" aria-label="anchor" href="#add-scale-bar-and-north-arrow"></a>
</h4>
<p>Scale bar and north arrows can be added using the <a href="https://paleolimbot.github.io/ggspatial/index.html" class="external-link"><strong>ggspatial</strong>
functions</a> (the package is automatically loaded when you use
ggOceanMaps):</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75</span>, <span class="op">-</span><span class="fl">45</span>, <span class="fl">62</span>, <span class="fl">78</span><span class="op">)</span>, rotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_scale.html" class="external-link">annotation_scale</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"br"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_north_arrow.html" class="external-link">annotation_north_arrow</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"tr"</span>, which_north <span class="op">=</span> <span class="st">"true"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>Note that the north arrow in the example above points towards North
where it is placed and that the direction of North varies as shown by
the meridians. The scale bar is correct at 71 <span class="math inline">\(\circ\)</span>N latitude as specified by the
projection (crs = 3995) for Arctic stereographic maps.</p>
</div>
</div>
<div class="section level3">
<h3 id="modifying-basemap-objects">Modifying basemap objects<a class="anchor" aria-label="anchor" href="#modifying-basemap-objects"></a>
</h3>
<p>The objects produced by the <code>basemap</code> function are
standard ggplot objects with the difference that relevant information
used in mapping is added to <code>attributes</code> of the object:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span><span class="op">-</span><span class="fl">60</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "names"      "class"      "bathymetry" "glaciers"   "limits"    </span></span>
<span><span class="co">#&gt; [6] "polarmap"   "map.grid"   "crs"        "proj"</span></span></code></pre></div>
<p>Accessing the <code>attributes</code> allow custom modifications of
maps produced by the <code>basemap</code> function. See the <a href="#reordering-layers">Reordering layers</a> section as an
example.</p>
<div class="section level4">
<h4 id="reordering-layers">Reordering layers<a class="anchor" aria-label="anchor" href="#reordering-layers"></a>
</h4>
<p>Sometimes there is a need to move land, glacier, and grid layers on
top of spatial data added on a <code>basemap</code>. This can be done
using the <code>reorder_layers</code> function. This example uses
Norwegian fishing regions (Hovedområder f.o.m. 2018), which can be
downloaded from the <a href="https://www.fiskeridir.no/" class="external-link">Norwegian
Directorate of Fisheries data portal</a> (use “ESRI shapefile” option).
The example works for any spatial polygons with crs information,
however.</p>
<p>The Norwegian fishing regions are included as an example dataset in
the <strong>ggOceanMaps</strong> package. You can download these data
and use the <code><a href="http://rgdal.r-forge.r-project.org/reference/readOGR.html" class="external-link">rgdal::readOGR</a></code> function to read the shapefile
if you wish to follow the example fully.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fishingAreasNor</span>, package <span class="op">=</span> <span class="st">"ggOceanMapsData"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span><span class="va">fishingAreasNor</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html" class="external-link">annotation_spatial</a></span><span class="op">(</span><span class="va">fishingAreasNor</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># required to keep the limits</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>The initial plot draws the polygons. Note how we had to add
<code>coord_sf(expand = FALSE)</code> because <code>layer_spatial</code>
and <code>annotation_spatial</code> functions from the ggspatial package
seem to modify <code>coord_sf</code> when added to the plot. The
<code>basemap</code> function uses <code>expand = FALSE</code> (run the
script without the addition and see the difference). Note also how the
polygon boundaries are partly on land. We want to eventually hide them
under land. We also add region labels and color the polygons based on
their area to demonstrate the capabilities of ggplot, ggspatial and
ggOceanMaps:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="va">fishingAreasNor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fishingAreasNor</span><span class="op">$</span><span class="va">area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">fishingAreasNor</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">1e9</span> <span class="co"># calculate area in 1000 km2</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span><span class="va">fishingAreasNor</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fishingAreasNor</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">area</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">labels</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">FID</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="../reference/FS.html">FS</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>, fontface <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Area\n(1000 km2)"</span>,</span>
<span>                       palette <span class="op">=</span> <span class="st">"Spectral"</span>, na.value <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span><span class="op">)</span>, oob <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/oob.html" class="external-link">squish</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/reorder_layers.html">reorder_layers</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<p>Ideally, the region labels should not go under land. This can be
fixed by plotting the labels on top of the reordered ggplot object. To
demonstrate how to reorder layers, we do this manually here:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reorder_layers.html">reorder_layers</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">layers</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">k</span><span class="op">$</span><span class="va">mapping</span><span class="op">$</span><span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="co"># the layer with label mapping</span></span>
<span><span class="va">p</span><span class="op">$</span><span class="va">layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">layers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">]</span>, <span class="va">p</span><span class="op">$</span><span class="va">layers</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="contolling-the-plotting-order-of-graticules">Contolling the plotting order of graticules<a class="anchor" aria-label="anchor" href="#contolling-the-plotting-order-of-graticules"></a>
</h4>
<p>Graticules are plotted using <a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link"><code>ggplot2::coord_sf()</code></a>
and are regarded as the <em>panel</em> element in the <a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link"><code>ggplot2::theme()</code></a>.
Note that also background color is included in the <em>panel</em>
element (see the next section). The <a href="https://mikkovihtakari.github.io/ggOceanMaps/reference/theme_map.html" class="external-link"><code>ggOceanMaps::theme_map()</code></a>
function, which is automatically executed together with every
<code><a href="../reference/basemap.html">basemap()</a></code> and <code><a href="../reference/qmap.html">qmap()</a></code> command, controls the
position of the graticules and they are set on top by default:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">50</span>, <span class="fl">70</span><span class="op">)</span>, grid.col <span class="op">=</span> <span class="st">"red"</span>, grid.size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<p>To move the graticules under all layers, use the
<code>panel.ontop</code> argument in <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code>:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">50</span>, <span class="fl">70</span><span class="op">)</span>, grid.col <span class="op">=</span> <span class="st">"red"</span>, grid.size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.ontop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<p>Sometimes there is a need to control the position of graticules in
between layers. At the time of writing, ggplot does not offer a
straightforward way to do this, but we can use the code from <a href="https://github.com/tidyverse/ggplot2/blob/7571122f6a9455ccce9f8ceb9a2196c0a70be646/R/coord-sf.R#L226" class="external-link"><code>ggplot2::coord_sf()</code></a>
to make the graticules:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ices_areas</span>, package <span class="op">=</span> <span class="st">"ggOceanMapsData"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">50</span>, <span class="fl">70</span><span class="op">)</span>, grid.col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> <span class="co"># without graticules </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ices_areas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">SubArea</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Make the graticules:</span></span>
<span><span class="va">lims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">$</span><span class="va">limits</span> </span>
<span><span class="va">graticule</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_graticule.html" class="external-link">st_graticule</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">lims</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">lims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">lims</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, </span>
<span>  crs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">$</span><span class="va">proj</span>,</span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span>, <span class="fl">15</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="../reference/reorder_layers.html">reorder_layers</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">graticule</span>, color <span class="op">=</span> <span class="st">"grey70"</span>, size <span class="op">=</span> <span class="fu"><a href="../reference/LS.html">LS</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># graticules</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">lims</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="va">lims</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="co"># redefine limits</span></span>
<span>           crs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">$</span><span class="va">proj</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="co"># labels on top of graticules</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf_label</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/valid.html" class="external-link">st_make_valid</a></span><span class="op">(</span><span class="va">ices_areas</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">Area_Full</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<p>An exception are the polar maps for which graticules are drawn by
ggOceanMaps (because ggplot2 graticules for those maps were bugged some
years ago when writing the function; this part requires a revision at
some point).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basemap_data.html">basemap_data</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span><span class="fl">60</span>, grid.col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggspatial</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/stat_spatial_identity.html" class="external-link">geom_spatial_path</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">X</span><span class="op">$</span><span class="va">map.grid</span><span class="op">$</span><span class="va">lon.grid.lines</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>, </span>
<span>    crs <span class="op">=</span> <span class="fl">4326</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggspatial</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/stat_spatial_identity.html" class="external-link">geom_spatial_path</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">X</span><span class="op">$</span><span class="va">map.grid</span><span class="op">$</span><span class="va">lat.grid.lines</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>, </span>
<span>    crs <span class="op">=</span> <span class="fl">4326</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggspatial</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html" class="external-link">layer_spatial</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">X</span><span class="op">$</span><span class="va">shapefiles</span><span class="op">$</span><span class="va">land</span>, </span>
<span>    fill <span class="op">=</span> <span class="st">"grey60"</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="coloring-the-ocean-background">Coloring the ocean (background)<a class="anchor" aria-label="anchor" href="#coloring-the-ocean-background"></a>
</h4>
<p>Similarly, the <a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link"><code>ggplot2::theme()</code></a>
<em>panel</em> element allows <a href="https://stackoverflow.com/questions/67615318/how-to-colour-the-ocean" class="external-link">coloring
the ocean</a>:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">129</span>, <span class="op">-</span><span class="fl">124</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">49</span>, <span class="fl">53</span><span class="op">)</span><span class="op">)</span>, grid.col <span class="op">=</span> <span class="st">"red"</span>, grid.size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span>,</span>
<span>        panel.ontop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
<p>If you want the graticules on top, you’ll need to define them
manually because, both, the background and the grid, are contained in
the same ggplot element called <em>panel</em>:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">129</span>, <span class="op">-</span><span class="fl">124</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">49</span>, <span class="fl">53</span><span class="op">)</span><span class="op">)</span>, grid.col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span>,</span>
<span>        panel.ontop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Make the graticules:</span></span>
<span><span class="va">lims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">$</span><span class="va">limits</span> </span>
<span><span class="va">graticule</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_graticule.html" class="external-link">st_graticule</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">lims</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">lims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">lims</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, </span>
<span>  crs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">$</span><span class="va">proj</span>,</span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">$</span><span class="va">map.grid</span><span class="op">$</span><span class="va">lon.breaks</span>, </span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">$</span><span class="va">map.grid</span><span class="op">$</span><span class="va">lat.breaks</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">graticule</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fu"><a href="../reference/LS.html">LS</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># graticules</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">lims</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="va">lims</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="co"># redefine limits</span></span>
<span>           crs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">$</span><span class="va">proj</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="add-a-fill-scale-on-top-of-bathymetry">Add a fill scale on top of bathymetry<a class="anchor" aria-label="anchor" href="#add-a-fill-scale-on-top-of-bathymetry"></a>
</h4>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">50</span>, <span class="fl">70</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html" class="external-link">annotation_spatial</a></span><span class="op">(</span><span class="va">ices_areas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Area_Full</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in `f()`:</span></span>
<span><span class="co"># ! Insufficient values in manual scale. 75 needed but only 9 provided.</span></span>
<span><span class="co"># Run `rlang::last_error()` to see where the error occurred.</span></span></code></pre></div>
<p>This error comes because ggplot does not allow two color scales with
similar mapping in one plot. The issue can be evaded by using contour
bathymetry:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">50</span>, <span class="fl">70</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        bathy.style <span class="op">=</span> <span class="st">"contour_blues"</span>, legends <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html" class="external-link">annotation_spatial</a></span><span class="op">(</span><span class="va">ices_areas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Area_Full</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
<p>Or by using the <a href="https://github.com/eliocamp/ggnewscale" class="external-link">ggnewscale</a> package to
make the data <code>fill</code> mapping disconnected from that in
<code>basemap</code>:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">50</span>, <span class="fl">70</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        bathy.style <span class="op">=</span> <span class="st">"poly_greys"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggnewscale</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggnewscale/man/new_scale.html" class="external-link">new_scale_fill</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html" class="external-link">annotation_spatial</a></span><span class="op">(</span><span class="va">ices_areas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Area_Full</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="custom-shapefiles">Custom shapefiles<a class="anchor" aria-label="anchor" href="#custom-shapefiles"></a>
</h4>
<p>The <strong>ggOceanMaps package uses vector (spatial polygon)
data</strong> to make the plotting more efficient and to produce sharp
images at any resolution. For the time being, the package supports three
kinds of shapefiles: 1) land shapes, 2) glacier shapes, and 3)
bathymetry shapes. Each of these shapes has to be defined using the same
projection. Since the shapefiles are large and generating them may
require long processing time, it is most convenient to save them in a
Rdata file as <code>sp::SpatialPolygonsDataFrames</code> objects and
load them to the memory when used to make a map. Useful sources for
spatial data are:</p>
<p><strong>Vector data</strong></p>
<ul>
<li>
<a href="http://www.naturalearthdata.com/downloads/10m-physical-vectors/" class="external-link">Natural
Earth Data</a> provides polygon data in relatively high detail for the
entire Earth. Used as data-source for land and glacier shapes throughout
the package, except for the most detailed maps.</li>
<li>
<a href="https://www.kartverket.no/" class="external-link">Norwegian Mapping Authority</a>
provides high-resolution spatial data for mainland Norway and Svalbard.
<!-- Used as data-source for detailed coastal Norwegian maps as well as for detailed bathymetry in Svalbard maps. -->
</li>
<li>
<a href="https://geodata.npolar.no/" class="external-link">Norwegian Polar Institute</a>
provides high-resolution vector data for Norwegian polar regions.
<!-- Used as data-source for detailed Svalbard maps.  -->
</li>
</ul>
<p><strong>Raster data for bathymetry</strong></p>
<ul>
<li>
<a href="https://www.gebco.net/data_and_products/gridded_bathymetry_data/gebco_2019/gebco_2019_info.html" class="external-link">GEBCO
Compilation Group (2019) GEBCO 2019 15-arcsecond grid</a>. The highest
resolution open bathymetry grid available at the moment. Referred to as
“GEBCO data”.</li>
<li>
<a href="https://www.ngdc.noaa.gov/mgg/global/relief/ETOPO1/docs/ETOPO1.pdf" class="external-link">ETOPO1
1 Arc-Minute Global Relief Model</a>. Can also be accessed using the <a href="https://www.rdocumentation.org/packages/marmap/versions/1.0.3/topics/getNOAA.bathy" class="external-link"><code>marmap::getNOAA.bathy</code></a>
(see <a href="#making">Section 1</a>). Referred to as “NOAA data” and
“ETOPO1 data”.</li>
</ul>
<p>There are probably more sources which the author has not needed yet.
Please send an email to add more options to the list. The bathymetry
datasets are large and require vectorization before they can be plotted
in <em>ggplot2</em> within a reasonable time.</p>
<p>Here we go through how to plot customized shapefiles for the Barents
Sea as an example. A similar procedure can be applied to any region in
the world.</p>
<div class="section level5">
<h5 id="bathymetries">Bathymetries<a class="anchor" aria-label="anchor" href="#bathymetries"></a>
</h5>
<p>The <a href="http://www.naturalearthdata.com/downloads/10m-physical-vectors/" class="external-link">Natural
Earth Data</a> provides bathymetry vector data, which can be readily
used in ggOceanMaps. The contours in that dataset are, however, not very
practical for marine biology and fisheries in shallow seas such as the
Barents Sea. Download the <a href="https://www.ngdc.noaa.gov/mgg/global/relief/ETOPO1/data/ice_surface/grid_registered/netcdf/" class="external-link">ETOPO1
dataset as grid registered NetCDF gmt4</a> to a folder in your computer.
It may be beneficial to make a “GIS” or “Shapefiles” folder where you
store similar datasets for later use. Whether you use ice or bed-rock
surface does not matter for this example as there are no glaciers under
the sea-level within the region of interest. In any case, this choice
has no visual effect because land and glaciers will be plotted on top of
the bathymetry, but the ice surface option will lead to smaller file
size.</p>
<p>The bathymetry needs first to be reclassified and formatted for the
consequent vectorization step. First, we need to define the location of
the ETOPO1 dataset and to find limits for our region in decimal degrees.
The limits can be found using the <code>basemap</code> function. It is
advised to use slightly wider limits than the region of interest.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">etopoPath</span> <span class="op">&lt;-</span> <span class="st">""</span> <span class="co"># Replace by the path to the folder where the ETOPO1 grd file is located.</span></span>
<span><span class="va">lims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>, <span class="fl">65</span>, <span class="fl">68</span>, <span class="fl">82</span><span class="op">)</span></span>
<span><span class="va">projection</span> <span class="op">&lt;-</span> <span class="st">"EPSG:32636"</span></span>
<span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="va">lims</span><span class="op">)</span></span></code></pre></div>
<p>We also need to define an appropriate projection. We will use the <a href="http://epsg.io/32636" class="external-link">UTM 36N zone projection</a>, which is
approximately in the middle of our area of interest. We define higher
resolution contour in depths 0-500 m because our area of interest is
relatively shallow. The <code>raster_bathymetry</code> function is
relatively slow for large data. The <code>aggregation.factor</code>
argument can be used to reduce file size but will influence the
resolution of the resulting shapefile (higher factors lead to a lower
resolution).</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/raster_bathymetry.html">raster_bathymetry</a></span><span class="op">(</span>bathy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">etopoPath</span>, <span class="st">"ETOPO1_Ice_g_gmt4.grd"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>,</span>
<span>                        depths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span>, <span class="fl">500</span>, <span class="fl">1000</span>, <span class="fl">1500</span>, <span class="fl">2000</span>, <span class="fl">4000</span>, <span class="fl">6000</span>, <span class="fl">10000</span><span class="op">)</span>, </span>
<span>                        proj.out <span class="op">=</span> <span class="va">projection</span>, </span>
<span>                        boundary <span class="op">=</span> <span class="va">lims</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we have the bathyRaster object which can be vectorized:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">rb</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rb</span><span class="op">)</span></span>
<span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rb</span><span class="op">$</span><span class="va">raster</span><span class="op">)</span></span></code></pre></div>
<p>The vectorization is done using the <code>vector_bathymetry</code>
function. The <code>drop.crumbs</code> and <code>remove.holes</code>
parameters can be used to reduce the file size, while the
<code>smooth</code> parameter makes the contours look smoother under
high zoom levels. Note that the smoothing of raster cell edges is
completely arbitrary and may lead to map contours that do not exist in
reality.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bs_bathy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vector_bathymetry.html">vector_bathymetry</a></span><span class="op">(</span><span class="va">rb</span><span class="op">)</span></span>
<span><span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">bs_bathy</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="land-shapes">Land shapes<a class="anchor" aria-label="anchor" href="#land-shapes"></a>
</h5>
<p>Land shapes could theoretically be defined from the bathymetry raster
(depth = 0). Nevertheless, since the <a href="http://www.naturalearthdata.com/downloads/10m-physical-vectors/" class="external-link">10m
Natural Earth Data</a> vectors are of high resolution, there has been no
need to write a function to do this. We use Natural Earth Data instead.
Download the Natural Earth Data <a href="http://www.naturalearthdata.com/downloads/10m-physical-vectors/" class="external-link">Land
and Minor Islands</a> vectors to your “GIS” or “Shapefiles” folder and
define folder paths under:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NEDPath</span> <span class="op">&lt;-</span> <span class="st">""</span> <span class="co"># Natural Earth Data location</span></span>
<span><span class="va">outPath</span> <span class="op">&lt;-</span> <span class="st">""</span> <span class="co"># Data output location</span></span></code></pre></div>
<p>Once done, we go ahead and process the shapefiles:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu">rgdal</span><span class="fu">::</span><span class="fu"><a href="http://rgdal.r-forge.r-project.org/reference/readOGR.html" class="external-link">readOGR</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">NEDPath</span>, <span class="st">"ne_10m_land/ne_10m_land.shp"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">islands</span> <span class="op">&lt;-</span> <span class="fu">rgdal</span><span class="fu">::</span><span class="fu"><a href="http://rgdal.r-forge.r-project.org/reference/readOGR.html" class="external-link">readOGR</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">NEDPath</span>, <span class="st">"ne_10m_minor_islands/ne_10m_minor_islands.shp"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">world</span>, <span class="va">islands</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bs_land</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clip_shapefile.html">clip_shapefile</a></span><span class="op">(</span><span class="va">world</span>, <span class="va">lims</span><span class="op">)</span></span>
<span><span class="va">bs_land</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spTransform.html" class="external-link">spTransform</a></span><span class="op">(</span><span class="va">bs_land</span>, CRSobj <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="va">projection</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/pred-unary-gIsValid.html" class="external-link">gIsValid</a></span><span class="op">(</span><span class="va">bs_land</span><span class="op">)</span> <span class="co"># Has to return TRUE, if not use rgeos::gBuffer</span></span>
<span><span class="va">bs_land</span> <span class="op">&lt;-</span> <span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html" class="external-link">gBuffer</a></span><span class="op">(</span><span class="va">bs_land</span>, byid <span class="op">=</span> <span class="cn">TRUE</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">bs_land</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="glacier-shapes">Glacier shapes<a class="anchor" aria-label="anchor" href="#glacier-shapes"></a>
</h5>
<p>Download the Natural Earth Data <a href="http://www.naturalearthdata.com/downloads/10m-physical-vectors/" class="external-link">Glaciated
Areas</a> vectors to your <code>NEDPath</code>.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glaciers</span> <span class="op">&lt;-</span> <span class="fu">rgdal</span><span class="fu">::</span><span class="fu"><a href="http://rgdal.r-forge.r-project.org/reference/readOGR.html" class="external-link">readOGR</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">NEDPath</span>, <span class="st">"ne_10m_glaciated_areas/ne_10m_glaciated_areas.shp"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/pred-unary-gIsValid.html" class="external-link">gIsValid</a></span><span class="op">(</span><span class="va">glaciers</span><span class="op">)</span> <span class="co"># Needs buffering</span></span>
<span><span class="va">glaciers</span> <span class="op">&lt;-</span> <span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html" class="external-link">gBuffer</a></span><span class="op">(</span><span class="va">glaciers</span>, byid <span class="op">=</span> <span class="cn">TRUE</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bs_glacier</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clip_shapefile.html">clip_shapefile</a></span><span class="op">(</span><span class="va">glaciers</span>, <span class="va">lims</span><span class="op">)</span></span>
<span><span class="va">bs_glacier</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spTransform.html" class="external-link">spTransform</a></span><span class="op">(</span><span class="va">bs_glacier</span>, CRSobj <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="va">projection</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/pred-unary-gIsValid.html" class="external-link">gIsValid</a></span><span class="op">(</span><span class="va">bs_glacier</span><span class="op">)</span></span>
<span><span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">bs_glacier</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="plotting-the-shapefiles-using-basemap">Plotting the shapefiles using basemap<a class="anchor" aria-label="anchor" href="#plotting-the-shapefiles-using-basemap"></a>
</h5>
<p>Now that we have the shapefiles, we can save them to a file so that
we do not run the script above every time we plot a map using custom
shapefiles.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">bs_bathy</span>, <span class="va">bs_land</span>, <span class="va">bs_glacier</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">outPath</span>, <span class="st">"bs_shapes.rda"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>, compress <span class="op">=</span> <span class="st">"xz"</span><span class="op">)</span></span></code></pre></div>
<p>The shapefiles can now be plotted using the <code>basemap</code>
function:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>shapefiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>land <span class="op">=</span> <span class="va">bs_land</span>, glacier <span class="op">=</span> <span class="va">bs_glacier</span>, bathy <span class="op">=</span> <span class="va">bs_bathy</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span>, glaciers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>
<p>The list elements <code>land</code>, <code>glacier</code> and
<code>bathy</code> are required, but <code>glacier</code> and
<code>bathy</code> can be set to <code>NULL</code> if
<code>bathymetry</code> and <code>glaciers</code> are set to
<code>FALSE</code>, respectively. This means that you are not forced to
define bathymetries and glaciers for your custom shapefile maps if
plotting them is not desired. Note how the map becomes plotted outside
its actual limits. This issue will hopefully be fixed in the future. The
map can be limited using the <code>limits</code> or <code>data</code>
arguments as any <code>basemap</code>:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">53</span>, <span class="fl">70</span>, <span class="fl">80</span><span class="op">)</span>, shapefiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>land <span class="op">=</span> <span class="va">bs_land</span>, glacier <span class="op">=</span> <span class="va">bs_glacier</span>, bathy <span class="op">=</span> <span class="va">bs_bathy</span><span class="op">)</span>, bathymetry <span class="op">=</span> <span class="cn">TRUE</span>, glaciers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-51-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="known-issues">Known issues<a class="anchor" aria-label="anchor" href="#known-issues"></a>
</h3>
<div class="section level4">
<h4 id="antimeridian-date-line-issues">Antimeridian (date-line) issues<a class="anchor" aria-label="anchor" href="#antimeridian-date-line-issues"></a>
</h4>
<p>As any decimal degree projection, the ggOceanMaps suffers from the
antimeridian issue for regions &lt; 30 and &gt; -30 latitude. Currently,
the <code>basemap</code> function plots the entire world instead of the
desired region:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">160</span>, <span class="op">-</span><span class="fl">160</span>, <span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="co"># not evaluated</span></span></code></pre></div>
<p>While this problem has yet to be solved, the projected maps <span class="math inline">\(\geq\)</span> 30 and <span class="math inline">\(\leq\)</span> -30 can tackle with
antimeridians:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">160</span>, <span class="op">-</span><span class="fl">160</span>, <span class="fl">30</span>, <span class="fl">60</span><span class="op">)</span>, rotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-53-1.png" width="700"></p>
<p>Note also that limiting the polar stereographic maps using decimal
degree longitude <code>limits[1:2]</code> using equal longitudes in
decimal degree space (e.g. <code>c(90, 90)</code>,
<code>c(-180, 180)</code>, …) is equal to limiting a map using latitude
argument furthest from the pole. This is because all limit points end up
along a single line in angular space. The function automatically
corrects for this definition error:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/basemap.html">basemap</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span>, <span class="op">-</span><span class="fl">70</span>, <span class="op">-</span><span class="fl">60</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggOceanMaps_files/figure-html/unnamed-chunk-54-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="citations-and-data-sources">Citations and data sources<a class="anchor" aria-label="anchor" href="#citations-and-data-sources"></a>
</h2>
<p>The data used by the package are not the property of the Institute of
Marine Research nor the author of the package. It is, therefore,
important that you cite the data sources used in a map you generate with
the package. Please see <a href="https://mikkovihtakari.github.io/ggOceanMaps/#citations-and-data-sources" class="external-link">here</a>
for a list of data sources.</p>
<p>Please cite the package whenever maps generated by the package are
published. For up-to-date citation information, please use:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"ggOceanMaps"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To cite package 'ggOceanMaps' in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Vihtakari M (2022). _ggOceanMaps: Plot Data on Oceanographic Maps</span></span>
<span><span class="co">#&gt;   using 'ggplot2'_. R package version 1.3.0,</span></span>
<span><span class="co">#&gt;   &lt;https://mikkovihtakari.github.io/ggOceanMaps/&gt;.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   @Manual{,</span></span>
<span><span class="co">#&gt;     title = {ggOceanMaps: Plot Data on Oceanographic Maps using 'ggplot2'},</span></span>
<span><span class="co">#&gt;     author = {Mikko Vihtakari},</span></span>
<span><span class="co">#&gt;     year = {2022},</span></span>
<span><span class="co">#&gt;     note = {R package version 1.3.0},</span></span>
<span><span class="co">#&gt;     url = {https://mikkovihtakari.github.io/ggOceanMaps/},</span></span>
<span><span class="co">#&gt;   }</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mikko Vihtakari.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
